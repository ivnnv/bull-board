{"version":3,"file":"static/js/async/src_components_UpdateJobDataModal_UpdateJobDataModal_tsx.js","sources":["/Users/ivnnv/Sites/ivnnv/bull-board/packages/ui/src/components/UpdateJobDataModal/UpdateJobDataModal.tsx"],"sourcesContent":["import type { AppJob } from '@bull-board/api/typings/app';\nimport React, { FormEvent } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useActiveQueue } from '../../hooks/useActiveQueue';\nimport { useJob } from '../../hooks/useJob';\nimport { useQueues } from '../../hooks/useQueues';\nimport { Button } from '../Button/Button';\nimport { JsonField } from '../Form/JsonField/JsonField';\nimport { Modal } from '../Modal/Modal';\n\nexport interface UpdateJobModalProps {\n  open: boolean;\n\n  job: AppJob;\n\n  onClose(): void;\n}\n\nexport const UpdateJobDataModal = ({ open, onClose, job }: UpdateJobModalProps) => {\n  const { queues } = useQueues();\n  const { actions: jobActions } = useJob();\n  const activeQueue = useActiveQueue();\n  const { t } = useTranslation();\n\n  if (!queues || !activeQueue) {\n    return null;\n  }\n\n  const updateJobData = async (evt: FormEvent) => {\n    evt.preventDefault();\n    const form = evt.target as HTMLFormElement;\n    const formData = Object.fromEntries(\n      Array.from(form.elements)\n        .filter((input: any) => input.name)\n        .map((input: any) => [input.name, input.value])\n    );\n\n    try {\n      formData.jobData = JSON.parse(formData.jobData);\n\n      await jobActions.updateJobData(activeQueue.name, job, formData)();\n      onClose();\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  return (\n    <Modal\n      width=\"small\"\n      open={open}\n      onClose={onClose}\n      title={t('UPDATE_JOB_DATA.TITLE')}\n      actionButton={\n        <Button type=\"submit\" theme=\"primary\" form=\"edit-job-data-form\">\n          {t('UPDATE_JOB_DATA.UPDATE')}\n        </Button>\n      }\n    >\n      <form id=\"edit-job-data-form\" onSubmit={updateJobData}>\n        <JsonField\n          label={t('UPDATE_JOB_DATA.JOB_DATA')}\n          value={job?.data || {}}\n          id=\"job-data\"\n          name=\"jobData\"\n        />\n      </form>\n    </Modal>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAUA;AAAA;;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;;;;;AAIA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AAKA;AAnDA;;AACA;AACA;AACA;AACA;;;AAJA"}